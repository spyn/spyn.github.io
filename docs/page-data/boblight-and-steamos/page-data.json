{"componentChunkName":"component---src-templates-blog-post-js","path":"/boblight-and-steamos/","result":{"data":{"site":{"siteMetadata":{"title":"360 Degrees of Awesome","author":"Mattie Ellins"}},"markdownRemark":{"id":"5a42f50c-08a8-54c9-93aa-1f8a6d6ab998","excerpt":"Having some spare time, I thought I would see if it is possible to setup boblightd with SteamOS.  It looks like it's possible, with X11 at least. https://codeâ€¦","html":"<p>Having some spare time, I thought I would see if it is possible to setup boblightd with SteamOS. </p>\n<p>It looks like it's possible, with X11 at least.</p>\n<p><a href=\"https://code.google.com/p/boblight/wiki/Compiling\">https://code.google.com/p/boblight/wiki/Compiling</a></p>\n<p>Firstly, I added the wheezy distro to apt sources. </p>\n<p>It doesn't look like the libraries that are required, so I'm going to have to add some apt repos\n<a href=\"http://steamcommunity.com/groups/steamuniverse/discussions/1/648816742742587380/\">http://steamcommunity.com/groups/steamuniverse/discussions/1/648816742742587380/</a></p>\n<p>Also, openssh-server, because I'm lazy and don't want to do it via the keyboard.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">sudo apt-get install libx11-dev libgl1-mesa-dev libxrender-dev libxext-dev portaudio19-dev libavcodec-dev libavformat-dev libavdevice-dev</code></pre></div>\n<p>I ommited libswscale-dev, as it appears another version is installed. Let's hope that it'll compile ok!</p>\n<p>It appears to be missing libusb too!</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">apt-get install libusb-1.0.0-dev</code></pre></div>\n<p>ffmpeg - because I think we want v4l support, for boblight</p>\n<p>but we need to install libswscale2 in order for it to compile --with-ffmpeg</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">apt-get remove ffmpeg libav-tools libavfilter2 libavfilter4 libswscale2 xbmc xbmc-bin</code></pre></div>\n<p>let's install XBMC again, because it's a nice to have</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">apt-get install xbmc</code></pre></div>\n<p>It's compling okay, let's build!</p>\n<p>oops, apt-get install libtool g++ (no g++ was found)</p>\n<p>Looks like boblight doesn't come with support for lightpack, so use this one </p>\n<blockquote>\n<p><a href=\"https://github.com/timsat/boblight-lightpack\">https://github.com/timsat/boblight-lightpack</a></p>\n</blockquote>\n<p>let's try that again... that worked</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">./configure --with-ffmpeg</code></pre></div>\n<p>You will have to open boblight-v4l.cpp and videogabber.cpp and add the unistd header to the code, for some reason this will cause errors when you try to compile boblight</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">vim src/clients/boblight-v4l/boblight-v4l.cpp\n(some where with the rest of the headers)\n#include &lt;unistd.h&gt;</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">vim src/clients/boblight-v4l/videograbber.cpp\n(some where with the rest of the headers)\n#include &lt;unistd.h&gt;</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">./configure --with-ffmpeg\nmake clean &amp;&amp; make\nsudo make install</code></pre></div>\n<p>Hooray, we have a build. Now, we need to edit /etc/boblight.conf</p>\n<p>First, let's find the USB device</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">desktop@steamos:/usr/src/boblight-read-only/arduino$ lsusb\nBus 001 Device 003: ID 1d50:6022 OpenMoko, Inc.</code></pre></div>\n<p>While we're playing with USB devices, we need to make the usb port readable by the steam user, so...</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">  idVendor           0x1d50 OpenMoko, Inc.\n  idProduct          0x6022</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">sudo vim /etc/udev/rules.d/69-persistent-usb.rules\nand add\nATTRS{idVendor}==&quot;1d50&quot;,ATTRS{idProduct}==&quot;6022&quot;,MODE=&quot;0666&quot;,GROUP=&quot;video&quot;</code></pre></div>\n<p>Here is my version of boblight.conf that I pulled from my XBMC media centre</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">sudo vim /etc/boblight.conf</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">[global]\ninterface 127.0.0.1\nport 19333\n\n[device]\nname ambilight\nchannels 30\ntype lightpack\noutput /dev/usb/hiddev0\ninterval 20000\ndebug on\n#bus 1\n#address 6\n#debug true\n\n[color]\nname red\nrgb FF0000\n\n[color]\nname green\nrgb 00FF00\n\n[color]\nname blue\nrgb 0000FF\n\n[light]\nname 1\ncolor red ambilight 28\ncolor green ambilight 29\ncolor blue ambilight 30\nhscan 0 16.67\nvscan 75 100\n\n[light]\nname 2\ncolor red ambilight 19\ncolor green ambilight 20\ncolor blue ambilight 21\nhscan 0 16.67\nvscan 50 75\n\n[light]\nname 3\ncolor red ambilight 16\ncolor green ambilight 17\ncolor blue ambilight 18\nhscan 0 16.67\nvscan 25 50\n\n[light]\nname 4\ncolor red ambilight 22\ncolor green ambilight 23\ncolor blue ambilight 24\nhscan 0 16.67\nvscan 0 25\n\n[light]\nname 5\ncolor red ambilight 25\ncolor green ambilight 26\ncolor blue ambilight 27\nhscan 0 16.67\nvscan 0 16.67\n\n\n[light]\nname 6\ncolor red ambilight 1\ncolor green ambilight 2\ncolor blue ambilight 3\nhscan 50 66.67\nvscan 0 16.67\n\n[light]\nname 7\ncolor red ambilight 10\ncolor green ambilight 11\ncolor blue ambilight 12\nhscan 66.67 83.33\nvscan 0 16.67\n\n[light]\nname 8\ncolor red ambilight 7\ncolor green ambilight 8\ncolor blue ambilight 9\nhscan 83.33 100\nvscan 0 16.67\n\n[light]\nname 9\ncolor red ambilight 13\ncolor green ambilight 14\ncolor blue ambilight 15\nhscan 83.33 100\nvscan 0 25\n\n[light]\nname 10\ncolor red ambilight 4\ncolor green ambilight 5\ncolor blue ambilight 6\nhscan 0 0\nvscan 0 0</code></pre></div>\n<p>We now need the daemon and the client to launch when lightvm loads</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">sudo vim /etc/X11/Xsession.d/91boblight</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token shebang important\">#!/bin/bash</span>\n<span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\"><span class=\"token environment constant\">DISPLAY</span></span><span class=\"token operator\">=</span>:0\nboblightd -f\n<span class=\"token function\">sleep</span> <span class=\"token number\">2</span>\nboblight-X11 -x -i <span class=\"token number\">0.03</span> -o <span class=\"token assign-left variable\">value</span><span class=\"token operator\">=</span><span class=\"token number\">5.0</span> -o <span class=\"token assign-left variable\">saturation</span><span class=\"token operator\">=</span><span class=\"token number\">2.0</span> -o <span class=\"token assign-left variable\">speed</span><span class=\"token operator\">=</span><span class=\"token number\">60.0</span> <span class=\"token operator\">&amp;</span></code></pre></div>\n<p>And we need to add it to Xsession.options</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">sudo vim /etc/X11/Xsession.options</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">boblight</code></pre></div>\n<p>Reboot, and you should have a working ambilight. I've found it to be completely slow and unuseable, but it was an experience.</p>\n<h3>These things FAILED</h3>\n<p>Now I tried doing this, but I could never get it to work. Appears SteamOS doesn't run through SysV? I don't know. I spent hours on this.</p>\n<p>Create a startup script in /etc/init.d</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">vim /etc/init.d/boblightd.sh</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token shebang important\">#!/bin/sh</span>\n<span class=\"token comment\">### BEGIN INIT INFO</span>\n<span class=\"token comment\"># Provides:          boblightd</span>\n<span class=\"token comment\"># Required-Start:    $all</span>\n<span class=\"token comment\"># Required-Stop:</span>\n<span class=\"token comment\"># Should-Start:</span>\n<span class=\"token comment\"># Default-Start:     2 3 4 5</span>\n<span class=\"token comment\"># Default-Stop:      0 1 6</span>\n<span class=\"token comment\"># Short-Description: Starts boblightd</span>\n<span class=\"token comment\">### END INIT INFO</span>\n<span class=\"token comment\"># OK GO</span>\n\n<span class=\"token assign-left variable\">prog</span><span class=\"token operator\">=</span><span class=\"token string\">\"BoblightD\"</span>\n\n<span class=\"token keyword\">case</span> <span class=\"token string\">\"<span class=\"token variable\">$1</span>\"</span> <span class=\"token keyword\">in</span>\n  start<span class=\"token punctuation\">)</span>\n        boblightd -f <span class=\"token operator\">></span> /dev/null <span class=\"token operator\"><span class=\"token file-descriptor important\">2</span>></span><span class=\"token file-descriptor important\">&amp;1</span>\n        <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"Starting boblightd...\"</span>\n        <span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n  stop<span class=\"token punctuation\">)</span>\n        <span class=\"token comment\"># No-op</span>\n        <span class=\"token function\">sudo</span> -S <span class=\"token function\">killall</span> boblightd\n        <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"Stopping boblightd...\"</span>\n        <span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n  *<span class=\"token punctuation\">)</span>\n        <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"Usage: boblightd.sh [start|stop]\"</span> <span class=\"token operator\">></span><span class=\"token file-descriptor important\">&amp;2</span>\n        <span class=\"token builtin class-name\">exit</span> <span class=\"token number\">3</span>\n        <span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">esac</span>\n<span class=\"token builtin class-name\">:</span></code></pre></div>\n<p>Needs to run BEFORE lightdm</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">desktop@steamos:~$ sudo update-rc.d boblightd.sh defaults</code></pre></div>","frontmatter":{"title":"boblightd and SteamOS","date":"2014, Nov 01","tags":["steamos","gaming","linux","ambi-light"],"img":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsTAAALEwEAmpwYAAABJElEQVQoz2NgwABMDCxMDAKcLIqi7Ea8LOoMDNyMQDFiACMDIyujmLFYWJ328tn6R6bpHoiUbuJglmcgqJ+REUiwa4l6LQk6fi79+dGU++WmS9oMNicpdDMwCDISoZmn2G/y9bkfXmz9PKtst71+foBux2K3U0p8zlB5PICJgV1f0ba3bMHBDef1lFIC7SeubL98f8InE8kIkCwe7WApZhMdZ0fzADkhq7L0hYe23ls14Wxp8Hon7QZRXjVIoODTrKvovnXVyYVTtz26/eb6vueh5stEmfNCrJbNqT/AzsKDTz8TIzBUuTTlXWb1b9i1+cz06l0zik5PLr2wb9mTnvoFTIzM0DjB7XigflZGBiF+Ni1gPOspevjbp9oY+bCxcqPpBAB8o1MPfs+PDQAAAABJRU5ErkJggg=="},"images":{"fallback":{"src":"/static/b6be248cdf669a402169b8e714366c6c/743e0/steamos-boblight.png","srcSet":"/static/b6be248cdf669a402169b8e714366c6c/4a226/steamos-boblight.png 750w,\n/static/b6be248cdf669a402169b8e714366c6c/743e0/steamos-boblight.png 785w","sizes":"100vw"},"sources":[{"srcSet":"/static/b6be248cdf669a402169b8e714366c6c/e0616/steamos-boblight.avif 750w,\n/static/b6be248cdf669a402169b8e714366c6c/bd3bc/steamos-boblight.avif 785w","type":"image/avif","sizes":"100vw"},{"srcSet":"/static/b6be248cdf669a402169b8e714366c6c/7d222/steamos-boblight.webp 750w,\n/static/b6be248cdf669a402169b8e714366c6c/6e09c/steamos-boblight.webp 785w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.43312101910828027}}}}}},"pageContext":{"slug":"/boblight-and-steamos/","previous":{"fields":{"slug":"/setting-up-steamos/"},"frontmatter":{"title":"Setting up SteamOS","tags":["gaming","steam-os","linux"],"img":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAQBAgX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAABwH0iqEkf/8QAGBAAAwEBAAAAAAAAAAAAAAAAAANBAQL/2gAIAQEAAQUCHJzlZIf/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAaEAABBQEAAAAAAAAAAAAAAAARAAESIEFh/9oACAEBAAY/AlJiO7X/xAAaEAACAwEBAAAAAAAAAAAAAAABIQAQETFx/9oACAEBAAE/IVsTsgB7LysjrV//2gAMAwEAAgADAAAAENMv/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFhEBAQEAAAAAAAAAAAAAAAAAARAR/9oACAECAQE/EByf/8QAGxABAQACAwEAAAAAAAAAAAAAAREAIRAxUUH/2gAIAQEAAT8QKBIfXNAMoIrueD3iNpvKhSw1Xrj/2Q=="},"images":{"fallback":{"src":"/static/39aac06b8a404382d110baf00f9b5017/2a97d/steam-os.jpg","srcSet":"/static/39aac06b8a404382d110baf00f9b5017/37bba/steam-os.jpg 750w,\n/static/39aac06b8a404382d110baf00f9b5017/2a97d/steam-os.jpg 785w","sizes":"100vw"},"sources":[{"srcSet":"/static/39aac06b8a404382d110baf00f9b5017/a66aa/steam-os.webp 750w,\n/static/39aac06b8a404382d110baf00f9b5017/fb719/steam-os.webp 785w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.5630573248407643}}}}},"next":{"fields":{"slug":"/illuminate/"},"frontmatter":{"title":"Yeelight and Hyperion tinkering","tags":["ambi-light","code","python","rpi"],"img":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAKABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMBBAX/xAAUAQEAAAAAAAAAAAAAAAAAAAAC/9oADAMBAAIQAxAAAAF1lGgnI4I//8QAGxAAAQQDAAAAAAAAAAAAAAAAAQIDERIAMkP/2gAIAQEAAQUCLtgJShuaNa8s/8QAFhEAAwAAAAAAAAAAAAAAAAAAEBIi/9oACAEDAQE/AWkf/8QAFhEBAQEAAAAAAAAAAAAAAAAAAwEQ/9oACAECAQE/AUOZ/8QAGhAAAgIDAAAAAAAAAAAAAAAAAAECESAhkf/aAAgBAQAGPwJrhG7RvD//xAAdEAEAAgICAwAAAAAAAAAAAAABABEhQRBRYYGx/9oACAEBAAE/IRQM9IzKDd1qXhWfJCabY5Hr7x//2gAMAwEAAgADAAAAEAvP/8QAFxEBAQEBAAAAAAAAAAAAAAAAAQARMf/aAAgBAwEBPxATrOzf/8QAFhEBAQEAAAAAAAAAAAAAAAAAARAR/9oACAECAQE/EAJqs//EABwQAQACAgMBAAAAAAAAAAAAAAEAESExEGFxUf/aAAgBAQABPxB7GJlzaxpwEtFerloQlooQ+TO08u4QaX28cf/Z"},"images":{"fallback":{"src":"/static/e2c2a89fdf1da4cf9c11f231272fb095/e83b7/yeelight.jpg","srcSet":"/static/e2c2a89fdf1da4cf9c11f231272fb095/5f965/yeelight.jpg 750w,\n/static/e2c2a89fdf1da4cf9c11f231272fb095/e83b7/yeelight.jpg 784w","sizes":"100vw"},"sources":[{"srcSet":"/static/e2c2a89fdf1da4cf9c11f231272fb095/ee7ce/yeelight.webp 750w,\n/static/e2c2a89fdf1da4cf9c11f231272fb095/98e31/yeelight.webp 784w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.5}}}}}}},"staticQueryHashes":["2478211480","63159454"]}